from gcode import GCode
from math import sin, cos, radians
from shapely.geometry import LineString, MultiLineString

F = 45
G0Z = 0.2

HEADER = GCode(['G90', 'G20', 'G0 Z%s' % G0Z, 'M4', 'G4 P2.0', 'F%s' % F])
FOOTER = GCode(['G0 Z%s' % G0Z, 'M8', 'G0 X3 Y6'])

M = [(-424.34998, 78.81022), (-435.67077189, 81.12403201), (-446.44089516, 85.14463484), (-456.4382824, 90.73120744), (-465.44086625, 97.74292875), (-473.22657932, 106.03897771), (-479.57335422, 115.47853328), (-484.25912357, 125.9207744), (-487.06182, 137.22488), (-490.99533922, 154.44795766), (-495.34752625, 173.23931625), (-498.96301443, 181.21436916), (-504.22204266, 187.17101422), (-511.63756861, 190.30575873), (-521.72255, 189.81511), (-528.42397348, 183.20988438), (-532.82982156, 175.41477437), (-537.2761425, 157.5026275), (-540.10421469, 138.57412188), (-542.48725184, 129.50856344), (-546.35674, 121.12471), (-550.99225565, 111.4111234), (-557.26984953, 102.82905219), (-564.93089834, 95.49365676), (-573.71677875, 89.5200975), (-583.36886744, 85.02353481), (-593.62854109, 82.11912906), (-604.23717639, 80.92204066), (-614.93615, 81.54743), (-626.58528314, 82.82805664), (-637.80505453, 85.91138937), (-648.35719209, 90.66922742), (-658.00342375, 96.97337), (-666.50547744, 104.69561633), (-673.62508109, 113.70776562), (-679.12396264, 123.88161711), (-682.76385, 135.08897), (-685.19125539, 146.57485145), (-685.89346062, 158.15832969), (-683.83165, 181.52048), (-679.99717688, 204.98022781), (-677.8088, 228.34238), (-657.74065125, 385.7069525), (-634.73623, 542.65421), (-631.92817106, 556.489135), (-626.79919469, 569.46072563), (-619.5972741, 581.32488406), (-610.5703825, 591.8375125), (-599.96649309, 600.75451313), (-588.03357906, 607.83178813), (-575.01961363, 612.82523969), (-561.17257, 615.49077), (-530.63794078, 616.94575125), (-515.03689357, 615.55513406), (-499.77249125, 612.45741), (-485.26408377, 607.43130281), (-471.93102109, 600.25553625), (-460.19265318, 590.70883406), (-450.46833, 578.56992), (-445.57287523, 569.28479145), (-442.23954625, 559.53386906), (-438.5050325, 539.1508125), (-435.7563225, 518.45308969), (-430.48495, 498.47304), (-422.25419408, 490.68490873), (-414.27532203, 488.28985484), (-406.82751115, 490.29255697), (-400.18993875, 495.69769375), (-394.64178213, 503.50994381), (-390.46221859, 512.73398578), (-387.93042545, 522.3744983), (-387.32558, 531.43616), (-382.11647844, 553.76989594), (-373.6285925, 575.20675), (-367.74273137, 584.89630629), (-360.54232531, 593.53059406), (-351.86242473, 600.83259731), (-341.53808, 606.5253), (-325.94149875, 612.48587367), (-309.36029875, 616.27491188), (-292.28887063, 617.76368789), (-275.221605, 616.823475), (-258.6528925, 613.32554648), (-243.07712375, 607.14117562), (-228.98868938, 598.1416357), (-216.88198, 586.1982), (-209.14874426, 574.11043514), (-203.39418781, 561.23326984), (-196.1885175, 533.81663375), (-187.56278, 477.27541), (-148.25938, 181.55862), (-147.95789094, 155.11220172), (-149.96290598, 141.85181197), (-153.5988675, 129.06373625), (-159.01110559, 117.12080037), (-166.34495031, 106.39583016), (-175.74573176, 97.26165143), (-187.35878, 90.09109), (-200.42881184, 84.31596674), (-214.64882219, 80.92650266), (-229.34885832, 80.02828756), (-243.8589675, 81.72691125), (-257.50919699, 86.12796354), (-269.62959406, 93.33703422), (-279.55020598, 103.4597131), (-286.60108, 116.60159), (-289.99656477, 125.8272893), (-291.80983313, 136.20543063), (-294.005555, 157.95135), (-296.0459257, 168.08528336), (-299.81991437, 176.90396937), (-306.15647961, 183.7904857), (-315.88458, 188.12791), (-325.74217531, 184.48996748), (-332.44979875, 178.06756359), (-336.77134406, 169.54009135), (-339.470705, 159.58694375), (-343.05844875, 138.12119453), (-345.47461906, 127.96737893), (-349.32418, 119.10546), (-352.55415832, 109.11525973), (-357.72941281, 100.37888719), (-364.53688527, 92.96470231), (-372.6635175, 86.941065), (-381.79625129, 82.3763352), (-391.62202844, 79.33887281), (-401.82779074, 77.89703777), (-412.10048, 78.11919), (-424.34998, 79.01663)]
E = [(176.34503, 72.59338), (151.3922225, 73.89755375), (126.57422, 73.34844), (95.01999763, 73.50956625), (63.568775, 73.91187), (21.1287704, 74.6779375), (-21.080551, 78.62171), (-32.73679694, 81.76413772), (-43.71662861, 86.56004484), (-53.85063988, 92.86202486), (-62.96942463, 100.52267125), (-70.90357673, 109.39457748), (-77.48369008, 119.33033703), (-82.54035854, 130.18254338), (-85.904176, 141.80379), (-91.33578673, 176.23793016), (-93.26079037, 211.10683875), (-94.343804, 281.11422), (-95.59418163, 406.05182375), (-95.17567077, 468.51580453), (-93.069162, 530.93728), (-90.42978145, 547.67107389), (-84.06687559, 562.78739984), (-74.56443612, 576.09323682), (-62.50645474, 587.39556375), (-48.47692313, 596.50135959), (-33.05983299, 603.21760328), (-16.83917602, 607.35127377), (-0.39894391, 608.70935), (107.98688576, 612.16993875), (216.3996, 610.47856), (239.46538109, 607.50344141), (261.47150875, 599.87095875), (271.39434834, 594.0768183), (280.23284953, 586.84067172), (287.71387064, 578.06996397), (293.56427, 567.67214), (298.55192879, 554.51045447), (301.01572344, 540.57577453), (300.97323137, 526.39556639), (298.44203, 512.49729625), (293.43969676, 499.40843033), (285.98380906, 487.65643484), (276.09194434, 477.768776), (263.78168, 470.27292), (252.45304164, 466.71031805), (240.89851312, 464.67799688), (217.334155, 463.918935), (169.94082, 466.6263), (152.39793984, 468.02984234), (142.94340768, 466.98791455), (134.27911125, 464.55975625), (127.33927342, 460.57754404), (123.05811703, 454.87345453), (122.36986494, 447.27966432), (126.20874, 437.62835), (132.31829266, 431.46441744), (139.49175687, 427.67359328), (147.47741203, 425.70748279), (156.0235375, 425.01769125), (173.79031688, 425.27348609), (190.77833, 424.05382), (208.99240078, 421.94739469), (226.49114125, 416.5725425), (241.87825859, 407.20500156), (248.34361709, 400.79764098), (253.75746, 393.12051), (260.45117297, 380.38494465), (264.63475312, 366.55048469), (266.29385109, 352.14579551), (265.4141175, 337.6995425), (261.98120297, 323.74039106), (255.98075812, 310.79700656), (247.39843359, 299.39805441), (236.21988, 290.0722), (224.66658217, 284.37620777), (212.60649984, 281.06271969), (187.46971875, 279.2252775), (161.81701078, 279.84391656), (136.65585, 278.20268), (127.82630096, 272.56628934), (123.50558891, 265.26343594), (123.06426147, 257.15525645), (125.87286625, 249.1028875), (131.30195088, 241.96746574), (138.72206297, 236.61012781), (147.50375014, 233.89201035), (157.01756, 234.67425), (209.4126775, 237.15646875), (235.56806937, 237.38493891), (261.45117, 234.0405), (275.26130912, 227.67420373), (287.12721422, 218.64136109), (296.9224919, 207.4335126), (304.52074875, 194.54219875), (309.79559139, 180.45896006), (312.62062641, 165.67533703), (312.86946041, 150.68287018), (310.4157, 135.9731), (306.75545406, 122.56086656), (300.68321, 109.76689), (292.56535594, 98.13805344), (282.76828, 88.22124), (268.20473797, 80.77949266), (252.26502375, 76.50369125), (219.37556, 73.34224), (197.96528, 72.31340125)]
G = [(761.08127, 75.03975), (751.5935625, 76.20743563), (743.18305375, 79.69628125), (728.24781, 90.68312), (713.58389375, 102.09160125), (705.51254437, 106.1075), (696.49966, 108.01306), (654.83177125, 91.35209875), (633.43159047, 84.90042859), (611.19514, 82.06681), (583.8761152, 80.91315275), (556.73530844, 83.11498766), (530.08327246, 88.51590467), (504.23056, 96.95949375), (479.48772379, 108.28934486), (456.16531656, 122.34904797), (434.57389105, 138.98219303), (415.024, 158.03237), (401.07934164, 173.73239164), (388.84455812, 190.69316), (378.2198493, 208.70985898), (369.105415, 227.5776725), (355.00816938, 267.04737875), (345.75442, 307.46375), (345.46077125, 354.36230156), (350.414655, 401.01586), (355.1551325, 423.94191856), (361.56234625, 446.43611094), (369.75458063, 468.37489785), (379.85012, 489.63474), (392.89373758, 512.26914836), (408.62861063, 533.02598), (426.75266586, 551.70697852), (446.96383, 568.1138875), (468.96002977, 582.04845055), (492.43919188, 593.31241125), (517.09924305, 601.7075132), (542.63811, 607.0355), (568.07547229, 611.72841535), (593.90255391, 614.37302281), (619.88368951, 614.87439699), (645.78321375, 613.1376125), (671.36546127, 609.06774395), (696.39476672, 602.56986594), (720.63546475, 593.54905309), (743.85189, 581.91038), (754.0886549, 575.02372906), (762.95312922, 566.729135), (770.41788486, 557.24138844), (776.45549375, 546.77528), (781.03852779, 535.54560031), (784.13955891, 523.76714), (785.731159, 511.65468969), (785.7859, 499.42304), (784.19017283, 483.50279549), (779.90848016, 467.87910766), (773.15343021, 453.03783506), (764.13763125, 439.46483625), (753.0736915, 427.64596979), (740.17421922, 418.06709422), (725.65182264, 411.21406811), (709.71911, 407.57275), (694.53812516, 407.97033578), (679.65480875, 411.47386375), (665.66232547, 417.86479984), (653.15384, 426.92461), (639.47964922, 440.07653125), (625.06843625, 453.4900825), (617.25170006, 458.58206898), (608.84901266, 461.6839825), (599.72647549, 462.11066289), (589.75019, 459.17695), (579.62803934, 452.03087984), (571.57009281, 443.2537725), (565.27367363, 433.17028141), (560.436105, 422.10506), (553.92681219, 398.32804), (549.6208, 374.51994), (548.06718359, 351.42972188), (547.69359375, 328.0089), (550.79121203, 305.22390563), (554.35771846, 294.37185352), (559.65122, 284.04117), (569.53237719, 264.98102391), (576.32009082, 256.12257568), (584.1789575, 248.33648625), (592.98877449, 242.09121228), (602.62933906, 237.85521047), (612.98044848, 236.09693748), (623.9219, 237.28485), (632.10342852, 242.14676568), (636.0932825, 247.92990859), (636.55184961, 254.24340252), (634.1395175, 260.69637125), (629.51667383, 266.89793857), (623.34370625, 272.45722828), (608.98895, 280.08547), (600.9876025, 284.09481846), (594.34863937, 289.53699891), (588.97555719, 296.13763147), (584.7718525, 303.62233625), (579.48656188, 320.14644297), (577.72074, 336.91428), (580.25593348, 346.88877348), (584.43327844, 356.22962219), (590.07725168, 364.72101856), (597.01233, 372.147155), (605.06299019, 378.29222395), (614.05370906, 382.94041781), (623.8089634, 385.87592902), (634.15323, 386.88295), (694.13143125, 386.68868875), (754.14222, 385.82506), (767.06830699, 385.41297752), (779.41067344, 382.39121953), (790.88300754, 377.05239771), (801.1989975, 369.68912375), (810.07233152, 360.59400932), (817.21669781, 350.05966609), (822.34578457, 338.37870576), (825.17328, 325.84374), (828.76503672, 300.04326031), (830.90060375, 274.0537225), (833.47417, 221.94569), (833.61629031, 189.09395688), (832.40143, 155.8299825), (830.06916356, 139.57939234), (825.93848969, 123.86892688), (819.52302098, 108.91298109), (810.33637, 94.92595), (799.92714734, 85.74104109), (787.73272875, 79.34913875), (774.52635578, 75.77409203)]
A1 = [(974.77, 75.76042), (963.56834477, 77.59076455), (952.945825, 81.18568578), (943.05117836, 86.37163006), (934.0331425, 92.97504375), (926.04045508, 100.82237322), (919.22185375, 109.74006484), (913.72607617, 119.55456498), (909.70186, 130.09232), (907.43133016, 146.333745), (908.06563375, 162.969985), (910.95118797, 179.5353725), (915.43441, 195.56424), (922.71221422, 217.30974266), (928.75134375, 239.41233625), (941.09399, 283.56692), (973.05674, 410.94793), (991.87007375, 486.077625), (1001.82051078, 523.50861531), (1013.2937, 560.50106), (1020.10062305, 574.75727477), (1029.49109687, 587.14826812), (1041.01921602, 597.51431867), (1054.239075, 605.695705), (1068.70476836, 611.5327057), (1083.97039062, 614.86559938), (1099.59003633, 615.53466461), (1115.1178, 613.38018), (1127.85658223, 609.60397061), (1139.66495781, 603.90206297), (1150.42150762, 596.49255416), (1160.0048125, 587.59354125), (1168.29345332, 577.42312131), (1175.16601094, 566.19939141), (1180.50106621, 554.14044861), (1184.1772, 541.46439), (1213.734325, 441.3996475), (1244.1964, 341.6045), (1252.78619375, 310.03386781), (1262.911875, 278.9112125), (1272.58414375, 247.67999094), (1279.8137, 215.78366), (1288.998375, 169.13610625), (1291.70880313, 145.64671484), (1290.4426, 121.92432), (1282.54256875, 107.48420141), (1271.8279, 94.97254375), (1258.51178125, 85.50098672), (1242.8074, 80.18117), (1231.97394551, 78.85123221), (1221.53635156, 80.17244328), (1211.68814746, 83.7878474), (1202.6228625, 89.34048875), (1194.53402598, 96.4734115), (1187.61516719, 104.82965984), (1182.05981543, 114.05227795), (1178.0615, 123.78431), (1176.77868594, 132.95255582), (1173.35058125, 140.59832344), (1168.13949219, 146.74689559), (1161.507725, 151.423555), (1153.81758594, 154.65358441), (1145.43138125, 156.46226656), (1128.02, 155.91672), (1091.9887625, 155.34510875), (1074.00648594, 154.69685859), (1056.2135, 152.68864), (1049.09489785, 146.644944), (1044.19258906, 138.95061391), (1037.9327375, 120.80221375), (1031.22571719, 102.62776422), (1025.76444746, 94.9008724), (1017.8633, 88.81159), (1008.22834094, 82.46485469), (997.5824925, 78.2181925), (986.30372281, 76.00543656)]
A2 = [(1109.8188, 278.67386), (1117.69154023, 281.68545147), (1123.03177187, 286.73271484), (1126.23329883, 293.33689361), (1127.689925, 301.01923125), (1126.94369063, 317.70335703), (1123.9435, 332.95504), (1119.80478262, 342.2627233), (1113.25079219, 347.82101141), (1105.20944629, 349.98653787), (1096.6086625, 349.11593625), (1088.3763584, 345.5658401), (1081.44045156, 339.69288297), (1076.72885957, 331.85369842), (1075.1695, 322.40492), (1073.25586055, 313.69191494), (1072.91240937, 304.70843703), (1074.18563477, 296.04007092), (1077.122025, 288.27240125), (1081.76806836, 281.99101268), (1088.17025312, 277.78148984), (1096.37506758, 276.2294174), (1106.429, 277.92038)]
N = [(1726.759, 78.31702), (1714.04040762, 80.30852613), (1701.98844219, 84.24490906), (1690.71490879, 89.92491309), (1680.3316125, 97.1472825), (1670.9503584, 105.7107616), (1662.68295156, 115.41409469), (1655.64119707, 126.05602606), (1649.9369, 137.4353), (1639.789425, 156.15915), (1626.209125, 172.6168), (1609.6534625, 185.8829525), (1590.5799, 195.03231), (1581.88772871, 196.38480928), (1574.61461719, 194.71411797), (1568.69655645, 190.59854736), (1564.0695375, 184.61640875), (1558.43258906, 169.36567266), (1557.1917, 153.5884), (1555.67872656, 135.34430422), (1552.8080375, 116.70577875), (1549.99403301, 108.01018467), (1545.79717969, 100.14187891), (1539.8696709, 93.40949338), (1531.8637, 88.12166), (1509.96886875, 81.98305641), (1487.0834, 79.08489625), (1464.28815625, 80.59290547), (1453.26213828, 83.36351295), (1442.664, 87.67281), (1431.2172125, 95.87521799), (1422.1658125, 105.88796391), (1415.21551875, 117.35656693), (1410.07205, 129.92654625), (1404.0284625, 156.95271047), (1401.6808, 184.13061), (1400.61305, 245.99175875), (1401.9651, 307.85908), (1402.46289062, 366.22168781), (1401.772175, 424.58828), (1401.30694687, 482.94505469), (1402.4812, 541.27821), (1403.76371504, 553.5391034), (1406.95141406, 565.37374906), (1411.90154043, 576.54353895), (1418.4713375, 586.809865), (1426.51804863, 595.93411918), (1435.89891719, 603.67769344), (1446.47118652, 609.80197973), (1458.0921, 614.06837), (1471.81285156, 617.16499727), (1485.913, 617.9859825), (1499.96694844, 616.55940336), (1513.5491, 612.9133375), (1526.23385781, 607.07586258), (1537.595625, 599.07505625), (1547.20880469, 588.93899617), (1554.6478, 576.69576), (1573.4789, 544.30740375), (1583.558275, 528.61956422), (1596.0519, 514.8669), (1605.43578711, 508.81841066), (1615.10028437, 506.64057594), (1624.5191707, 507.83407324), (1633.166225, 511.89958), (1640.51522617, 518.33777363), (1646.03995312, 526.64933156), (1649.21418477, 536.33493121), (1649.5117, 546.89525), (1651.40299219, 565.36957203), (1656.1272875, 583.61707625), (1660.15646074, 591.77405908), (1665.61946406, 598.81628234), (1672.75815723, 604.391061), (1681.8144, 608.14571), (1697.61688711, 613.22853061), (1714.15454062, 615.44194297), (1730.85716133, 614.81706916), (1747.15455, 611.38503125), (1762.47650742, 605.17695131), (1776.25283437, 596.22395141), (1787.91333164, 584.55715361), (1796.8878, 570.20768), (1801.45210527, 556.43673287), (1804.54899219, 542.36121484), (1807.4837875, 513.58006125), (1808.3204, 455.48245), (1808.4241875, 400.771385), (1807.0891, 346.18977), (1805.81499375, 296.67296297), (1805.7872, 247.06558875), (1805.79000625, 197.43728766), (1804.6077, 147.8577), (1802.98196367, 134.63409264), (1798.90379063, 121.98327422), (1792.63202227, 110.26658525), (1784.4255, 99.84536625), (1774.54306523, 91.08095772), (1763.24355938, 84.33470016), (1750.78582383, 79.96793408), (1737.4287, 78.342), (1726.759, 78.317)]

def load_letters():
    scale = 0.011153752112
    shapes = [
        LineString(M),
        LineString(E),
        LineString(G),
        MultiLineString([LineString(A1), LineString(A2)]),
        LineString(N),
    ]
    result = []
    for shape in shapes:
        g = GCode.from_geometry(shape, 0.2, -0.1875)
        g = g.scale(scale, scale).move(3, 0, 0.5, 0)
        result.append(g)
    return result

def main():
    gs = load_letters()
    for g0, letter in zip(gs, 'megan'):
        g1 = g0.depth(0.2, -0.4)
        g2 = g0.depth(0.2, -0.6)
        p1 = HEADER + g0 + FOOTER
        p2 = HEADER + g1 + g2 + FOOTER
        p1.save('megan/%s1.nc' % letter)
        p2.save('megan/%s2.nc' % letter)
        im = g0.render(0, 0, 6, 8, 96)
        im.write_to_png('megan/%s.png' % letter)

if __name__ == '__main__':
    main()
